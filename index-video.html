<html lang="en">
<head>
    <title></title>
</head>
<body>
    Hello!
    <br/>
    <div id="video">
      <video loop muted autoplay playsinline style="width: 500px">
        <source
          src="https://wixmp-e655b44a6e13731b4eedaadd.wixmp.com/Highest%20Peak.mp4"
          type="video/mp4"
        />
      </video>
      <br />
      <input
        id="videoURL"
        type="text"
        placeholder="Enter new video URL and press Enter"
        style="width: 100%;"
      />
      <button id="playPause">Play / Pause</button>
      <script>
        const video = document.querySelector('video');
        const videoSource = video.querySelector('source');
        const videoURLInput = document.getElementById('videoURL');
        const videoPlayPauseButton = document.getElementById('playPause');

        function changeVideo(videoURL) {
          videoURLInput.value = videoURL;
            
          video.pause();
          videoSource.src = videoURL;
          video.load();
      
          video.play().catch(() => {
            console.warn('Autoplay blocked, user interaction needed');
          });
        }

        function changeVideoFromUrlParam() {
          const searchParams = new URLSearchParams(window.location.search);
          const videoURL = searchParams.get('videoUrl');
          if (typeof videoURL === 'string') {
            changeVideo(videoURL.trim());
          }
        }
        
        function changeVideoFromInput() {
          const videoURL = videoURLInput.value.trim();
          if (videoURL) {
            changeVideo(videoURL)
          };
        }

        changeVideoFromUrlParam();
        
        videoURLInput.value = videoSource.src;
        videoURLInput.addEventListener('change', () => {
          changeVideoFromInput();
        });
      
        videoPlayPauseButton.addEventListener('click', () => {
          video.paused ? video.play() : video.pause();
        });
      </script>
    </div>  
    <div id="lagRadar"></div>
    <div>
        Induce Lag:
        <input id="lagInput" type="range" min="0" max="1000" value="0">
        <span id="lagValue">0</span>ms
    </div>
    <script type="module">
        import lagRadar from 'https://mobz.github.io/lag-radar/lag-radar.js';

        lagRadar({ parent: document.getElementById('lagRadar') });

        const searchParams = new URLSearchParams(window.location.search);
        const iframeSrc = searchParams.get('iframeSrc');
      
        if (typeof iframeSrc === 'string') {
            const iframe = document.createElement('iframe');
            iframe.src = iframeSrc;
            iframe.style = 'width: 100%; height: 500px';
            
            document.body.appendChild(iframe);
        }

        (function lagMe() {
            const lagString = document.getElementById('lagInput').value;
            const lag = parseInt(lagString, 10);
            const t1 = Date.now() + lag;

            document.getElementById('lagValue').textContent = lagString;

            while (Date.now() < t1) {}

            window.requestAnimationFrame(lagMe);
        })();
    </script>
</body>
</html>
